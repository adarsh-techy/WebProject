<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><%= title %> | EventHub</title>
  
  <!-- Fonts & Icons -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <style>
    :root {
      --netflix-red: #e50914;
      --netflix-dark: #141414;
      --netflix-dark-gray: #222;
      --netflix-light-gray: #e5e5e5;
      --netflix-white: #fff;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: "Montserrat", sans-serif;
      background-color: #121212;
      color: #fff;
      line-height: 1.6;
    }

    /* ========== NAVBAR ========== */
    .navbar {
      background-color: var(--netflix-dark);
      padding: 0.8rem 2rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: sticky;
      top: 0;
      z-index: 1000;
      height: 80px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.8);
    }

    .nav-brand {
      display: flex;
      align-items: center;
    }

    .nav-logo {
      width: 140px;
      height: 60px;
      transition: transform 0.3s ease;
    }

    .nav-logo:hover {
      transform: scale(1.05);
    }

    .nav-search {
      flex: 1;
      margin: 0 2rem;
      max-width: 600px;
      position: relative;
    }

    .search-form {
      width: 100%;
    }

    .search-input {
      width: 100%;
      padding: 0.6rem 1rem 0.6rem 2.5rem;
      border-radius: 25px;
      border: none;
      background-color: #333;
      color: white;
      font-size: 0.95rem;
      transition: all 0.3s ease;
    }

    .search-input:focus {
      outline: none;
      background-color: #444;
      box-shadow: 0 0 0 2px rgba(229, 9, 20, 0.3);
    }

    .search-icon {
      position: absolute;
      left: 15px;
      top: 50%;
      transform: translateY(-50%);
      color: #999;
      font-size: 0.9rem;
    }

    .nav-links {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .nav-link {
      color: var(--netflix-white);
      text-decoration: none;
      font-weight: 800;
      font-size: 1rem;
      padding: 0.5rem 1rem;
      border-radius: 4px;
      transition: all 0.3s ease;
      /* font-family: 'Orbitron', sans-serif; */
      letter-spacing: 0.5px;
    }

    .nav-link:hover {
      background-color: #0d50ee;
      color: white;
    }

    .profile-dropdown {
      position: relative;
      cursor: pointer;
      margin-left: 0.5rem;
    }

    .profile-image {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px solid var(--netflix-red);
      transition: transform 0.3s ease;
    }

    .profile-icon {
      font-size: 1.5rem;
      color: var(--netflix-white);
      transition: transform 0.3s ease;
    }

    .dropdown-content {
      display: none;
      position: absolute;
      right: 0;
      top: 50px;
      background-color: var(--netflix-dark-gray);
      min-width: 160px;
      border-radius: 5px;
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
      z-index: 1000;
      overflow: hidden;
    }

    .dropdown-content.show {
      display: block;
    }

    .dropdown-link {
      display: block;
      padding: 0.8rem 1rem;
      color: var(--netflix-white);
      text-decoration: none;
      font-size: 0.9rem;
      transition: background-color 0.3s;
    }

    .dropdown-link:hover {
      background-color: var(--netflix-red);
    }

    .login-btn {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      background-color: var(--netflix-red);
      color: white;
      padding: 0.5rem 1rem;
      border-radius: 4px;
      text-decoration: none;
      transition: all 0.3s ease;
    }

    .login-btn:hover {
      background-color: white;
      color: var(--netflix-red);
    }

    /* ========== MAIN CONTENT ========== */
    .events-header {
      padding: 3rem 2rem 2rem;
      text-align: center;
    }

    .events-header h1 {
      font-size: 2.5rem;
      margin-bottom: 0.5rem;
        background: linear-gradient(100deg, #0400ff, #ff1c1c);
   background-clip: text;
  color: transparent;
    
    }

    .events-header p {
      color: var(--netflix-light-gray);
      font-size: 1.1rem;
    }

    .events-container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 2rem;
      padding: 2rem;
      max-width: 1400px;
      margin: 0 auto;
    }

    .event-card {
      background-color: var(--netflix-dark-gray);
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
      transition: transform 0.3s ease-in;
      
    }
    /* .event-card:hover > (:hover){
      opacity: 0.3;
    } */


.like-btn {
  position: absolute;
  top: 15px;
  right: 15px;
  background: rgba(0, 0, 0, 0.6);
  border: none;
  width: 36px;
  height: 36px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  color: white;
  font-size: 1.1rem;
  transition: all 0.3s ease;
  z-index: 10;
}
.like-btn:hover {
  background: rgba(229, 9, 20, 0.8);
  transform: scale(1.1);
}

.like-btn .fas.fa-heart {
  color: var(--netflix-red);
}

.like-count {
  float: right;
  font-size: 0.8rem;
  color: var(--netflix-light-gray);
  margin-left: 10px;
}


    .event-card:hover {
      transform: scale(1.1);
    }

    .event-image {
      width: 100%;
      height: 240px;
      object-fit: cover;
     
    }

    .event-info {
      padding: 1.1rem;
    }

    .event-date {
      color: #5d8bf8;
      font-weight: bold;
      margin-bottom: 0.5rem;
      font-size: 0.9rem;
    }

    .event-title {
      font-size: 1.3rem;
      margin-bottom: 0.5rem;
    }

    .event-description {
      color: var(--netflix-light-gray);
      margin-bottom: 1.5rem;
      font-size: 0.9rem;
    }

    .book-btn {
      display: inline-block;
      padding: 0.6rem 1.5rem;
      background-color: #0d50ee;
      color: white;
      border: none;
      border-radius: 4px;
      font-weight: 600;
      text-decoration: none;
      transition: all 0.3s ease;
    }

    .book-btn:hover {
      background-color: #ffffff;
      color: #0d50ee;
      transform: translateY(-2px);
    }

    .no-events {
      text-align: center;
      grid-column: 1 / -1;
      padding: 3rem;
    }

    .no-events p {
      font-size: 1.2rem;
      color: var(--netflix-light-gray);
      margin-bottom: 1.5rem;
    }

    /* ========== RESPONSIVE ========== */
    @media (max-width: 1024px) {
      .nav-search {
        margin: 0 1rem;
      }
      
      .nav-link {
        font-size: 0.9rem;
        padding: 0.5rem 0.8rem;
      }
    }

    @media (max-width: 768px) {
      .navbar {
        flex-wrap: wrap;
        height: auto;
        padding: 1rem;
        gap: 1rem;
      }
      
      .nav-brand {
        order: 1;
      }
      
      .nav-search {
        order: 3;
        width: 100%;
        margin: 0.5rem 0 0 0;
      }
      
      .nav-links {
        order: 2;
        margin-left: auto;
      }
      
      .events-header {
        padding: 2rem 1rem;
      }
      
      .events-header h1 {
        font-size: 2rem;
      }
      
      .events-container {
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        padding: 1rem;
      }
    }

    @media (max-width: 480px) {
      .navbar {
        padding: 0.8rem;
      }
      
      .nav-logo {
        width: 100px;
      }
      
      .nav-links {
        gap: 0.5rem;
      }
      
      .nav-link {
        padding: 0.4rem 0.6rem;
        font-size: 0.8rem;
      }
      
      .login-btn {
        padding: 0.4rem 0.8rem;
        font-size: 0.8rem;
      }
      
      .profile-image {
        width: 32px;
        height: 32px;
      }
      
      .events-header h1 {
        font-size: 1.8rem;
      }
      
      .events-container {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <!-- Navbar -->
  <nav class="navbar">
    <div class="nav-brand">
      <a href="/user/page">
        <img class="nav-logo" src="/images/gigforge_navbar_logo.png" alt="EventHub Logo">
      </a>
    </div>
    
    <div class="nav-search">
      <form class="search-form" action="/events/search" method="GET">
        <i class="fas fa-search search-icon"></i>
        <input 
          type="text" 
          class="search-input" 
          name="q" 
          placeholder="Search events..." 
           value="<%= typeof searchQuery !== 'undefined' ? searchQuery : '' %>"
        >
      </form>
    </div>
    
    <div class="nav-links">
      <a href="/user/page" class="nav-link">Home</a>
      <a href="#contact" class="nav-link">Contact</a>
      
      <!-- <% if (userEmail) { %>
        <div class="profile-dropdown" id="profileDropdown">
          <% if(userProfileImage) { %>
            <img src="data:<%= userProfileImage.contentType %>;base64,<%= userProfileImage.data.toString('base64') %>" 
                 class="profile-image" alt="Profile">
          <% } else { %>
            <i class="fas fa-user-circle profile-icon"></i>
          <% } %>
          <div class="dropdown-content" id="dropdownMenu">
            <a href="/user/profile" class="dropdown-link">My Profile</a>
            <a href="/user/logout" class="dropdown-link">Logout</a>
          </div>
        </div>
      <% } else { %>
        <a href="/user/login" class="login-btn">
          <i class="fas fa-sign-in-alt"></i>
          <span>Login</span>
        </a>
      <% } %> -->
    </div>
  </nav>

  <!-- Main Content -->
  <main>
    <div class="events-header">
      <h1><%= title %></h1>
      <% if (searchQuery) { %>
        <p>Showing results for "<%= searchQuery %>"</p>
      <% } else { %>
        <p>Discover all upcoming events</p>
      <% } %>
    </div>

    <div class="events-container">
  <% if (events.length === 0) { %>
    <div class="no-events">
      <% if (searchQuery) { %>
        <p>No events found matching your search.</p>
        <a href="/events" class="book-btn">View All Events</a>
      <% } else { %>
        <p>No upcoming events at the moment. Please check back later.</p>
      <% } %>
    </div>
  <% } else { %>
    <% events.forEach(event => { %>
      <div class="event-card">
        <img class="event-image" 
             src="<% if (event.concertImage && event.concertImage.data && event.concertImage.contentType) { %>data:<%= event.concertImage.contentType %>;base64,<%= event.concertImage.data.toString('base64') %><% } else { %>/images/placeholder.jpg<% } %>" 
             alt="<%= event.title %>">
        <div class="event-info">
          <div class="event-date">
            <%= event.date.toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' }) %>
            <span class="like-count"><%= event.likesCount %></span>
          </div>
          <h3 class="event-title"><%= event.title %></h3>
          <p class="event-description"><%= event.description.substring(0, 100) %>...</p>
          <a href="/concert/<%= event._id %>" class="book-btn">Book Now</a>
        </div>
      </div>
    <% }) %>
  <% } %>
</div>
  </main>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const searchInput = document.querySelector('.search-input');
    const searchForm = document.querySelector('.search-form');
    const profileDropdown = document.querySelector('#profileDropdown');
    const dropdownMenu = document.querySelector('#dropdownMenu');
    let searchTimer;

    // Existing search input event listener
    searchInput.addEventListener('input', function() {
      clearTimeout(searchTimer);
      if (this.value.length >= 3 || this.value.length === 0) {
        searchTimer = setTimeout(() => {
          searchForm.submit();
        }, 800);
      }
    });

    // Existing form submission prevention
    searchForm.addEventListener('submit', function(e) {
      if (searchInput.value.length > 0 && searchInput.value.length < 3) {
        e.preventDefault();
        alert('Please enter at least 3 characters to search');
      }
    });

    // New code for dropdown toggle
    if (profileDropdown && dropdownMenu) {
      profileDropdown.addEventListener('click', function(e) {
        e.stopPropagation(); // Prevent click from bubbling up to document
        dropdownMenu.classList.toggle('show');
      });

      // Close dropdown when clicking outside
      document.addEventListener('click', function(e) {
        if (!profileDropdown.contains(e.target)) {
          dropdownMenu.classList.remove('show');
        }
      });
    }
  });
</script>
</body>
</html>